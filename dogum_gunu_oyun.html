<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <title>Doƒüum G√ºn√º Oyunu</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, sans-serif;
    }

    body {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, #ff9a9e, #fecfef);
    }

    .game-wrapper {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 20px;
      padding: 16px 18px 20px;
      box-shadow: 0 18px 40px rgba(0, 0, 0, 0.2);
      max-width: 480px;
      width: 100%;
    }

    .header {
      text-align: center;
      margin-bottom: 10px;
    }

    .header h1 {
      font-size: 1.4rem;
      color: #ff4b6e;
      margin-bottom: 4px;
    }

    .info-row {
      display: flex;
      justify-content: space-between;
      font-size: 0.9rem;
      margin-top: 8px;
      color: #444;
    }

    .controls {
      font-size: 0.8rem;
      text-align: right;
      margin-top: 4px;
      color: #666;
    }

    .game-area {
      margin-top: 12px;
      border-radius: 16px;
      background: #fff;
      border: 2px solid #ffb6c9;
      position: relative;
      overflow: hidden;
      height: 320px;
    }

    /* FOTOƒûRAF buraya geliyor */
    .player {
      position: absolute;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      width: 70px;
      height: 70px;
      background-image: url("dilara.jpeg");
      background-size: contain;
      background-repeat: no-repeat;
      background-position: center;
    }

    /* Fƒ±ndƒ±k */
    .gift {
      position: absolute;
      top: -50px;
      width: 48px;
      height: 48px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
    }

    .gift::before {
      content: "üå∞";
    }

    .toast {
      position: absolute;
      left: 50%;
      top: 12px;
      transform: translateX(-50%);
      background: rgba(255, 75, 110, 0.95);
      color: #fff;
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 0.8rem;
      opacity: 0;
      transition: opacity 0.2s ease;
      pointer-events: none;
    }

    .toast.show {
      opacity: 1;
    }

    .win-overlay {
      position: absolute;
      inset: 0;
      background: rgba(0, 0, 0, 0.6);
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      opacity: 0;
      pointer-events: none;
      transition: 0.3s;
      color: #fff;
      text-align: center;
    }

    .win-overlay.visible {
      opacity: 1;
      pointer-events: auto;
    }

    .win-box {
      background: rgba(255,255,255,0.1);
      padding: 20px;
      border-radius: 20px;
      border: 1px solid rgba(255,255,255,0.4);
    }

    .win-btn {
      margin-top: 10px;
      padding: 8px 16px;
      background: #ff4b6e;
      color: #fff;
      border: none;
      border-radius: 10px;
      cursor: pointer;
    }

    .confetti {
      position: absolute;
      width: 8px;
      height: 14px;
      border-radius: 3px;
      animation: fall 1s linear forwards;
    }

    @keyframes fall {
      to { transform: translateY(260px) rotate(260deg); opacity: 0; }
    }
  </style>
</head>
<body>

<div class="game-wrapper">
  <div class="header">
    <h1>Mini Game!</h1>
  </div>

  <div class="info-row">
    <div>Puan: <span id="score">0</span> / 25</div>
    <div>Rekor: <span id="best">0</span></div>
  </div>

  <div class="controls">‚Üê ‚Üí veya A / D</div>

  <div class="game-area" id="game">
    <div class="toast" id="toast">+1 üå∞</div>
    <div class="player" id="player"></div>
    <div class="win-overlay" id="win">
      <div class="win-box">
        <h2>ƒ∞yi ki doƒüdun Dilo≈ü üíó</h2>
        <p>Nice mutlu yƒ±llara g√ºzellik!</p>
        <button class="win-btn" id="restartBtn">Tekrar oyna</button>
      </div>
    </div>
  </div>
</div>

<script>
  const TARGET_SCORE = 25;
  const GIFT_COUNT = 4;
  const GIFT_MIN_SPEED = 1.3;
  const GIFT_MAX_SPEED = 2.6;

  const game = document.getElementById("game");
  const player = document.getElementById("player");
  const scoreEl = document.getElementById("score");
  const bestEl = document.getElementById("best");
  const toast = document.getElementById("toast");
  const winOverlay = document.getElementById("win");
  const restartBtn = document.getElementById("restartBtn");

  let gameWidth, gameHeight;
  let playerX = 0;
  let score = 0;
  let best = Number(localStorage.getItem("bestFGame") || 0);
  let running = true;
  const keys = { left:false, right:false };
  let gifts = [];

  bestEl.textContent = best;

  function resize(){
    const r = game.getBoundingClientRect();
    gameWidth = r.width;
    gameHeight = r.height;
    playerX = gameWidth/2 - player.offsetWidth/2;
    player.style.left = playerX+"px";
  }

  function randomX() {
    // geni≈üliƒüi her seferinde elemandan oku ki tam alan kullanƒ±lsƒ±n
    const w = game.clientWidth || gameWidth || 0;
    return Math.random() * (w - 48);
  }

  function spawnGifts(){
    for(let i=0;i<GIFT_COUNT;i++){
      const el = document.createElement("div");
      el.className="gift";
      game.appendChild(el);
      const g = {
        el,
        x: randomX(),
        y: -Math.random()*200-40,
        s: GIFT_MIN_SPEED + Math.random()*(GIFT_MAX_SPEED-GIFT_MIN_SPEED),
      };
      el.style.left=g.x+"px";
      el.style.top=g.y+"px";
      gifts.push(g);
    }
  }

  function resetGift(g){
    g.y = -40 - Math.random()*160;
    g.x = randomX();
    g.s = GIFT_MIN_SPEED + Math.random()*(GIFT_MAX_SPEED-GIFT_MIN_SPEED);
  }

  function checkCollision(a,b){
    const r1=a.getBoundingClientRect();
    const r2=b.getBoundingClientRect();
    return !(r2.right<r1.left||r2.left>r1.right||r2.bottom<r1.top||r2.top>r1.bottom);
  }

  function showToast(){
    toast.classList.add("show");
    setTimeout(()=>toast.classList.remove("show"),250);
  }

  function win(){
    running=false;
    winOverlay.classList.add("visible");
  }

  function update(){
    if(!running)return;

    if(keys.left) playerX-=5;
    if(keys.right) playerX+=5;
    if(playerX<0) playerX=0;
    if(playerX>gameWidth-player.offsetWidth) playerX=gameWidth-player.offsetWidth;
    player.style.left=playerX+"px";

    gifts.forEach(g=>{
      g.y+=g.s;
      if(g.y>gameHeight) resetGift(g);
      g.el.style.top=g.y+"px";
      g.el.style.left=g.x+"px";

      if(checkCollision(player,g.el)){
        score++;
        scoreEl.textContent=score;
        resetGift(g);
        showToast();

        if(score>best){
          best=score;
          bestEl.textContent=best;
          localStorage.setItem("bestFGame",best);
        }

        if(score>=TARGET_SCORE) win();
      }
    });

    requestAnimationFrame(update);
  }

  window.addEventListener("keydown",e=>{
    if(e.key==="ArrowLeft"||e.key==="a") keys.left=true;
    if(e.key==="ArrowRight"||e.key==="d") keys.right=true;
  });
  window.addEventListener("keyup",e=>{
    if(e.key==="ArrowLeft"||e.key==="a") keys.left=false;
    if(e.key==="ArrowRight"||e.key==="d") keys.right=false;
  });

  restartBtn.onclick=_=>{
    score=0;
    scoreEl.textContent=0;
    running=true;
    gifts.forEach(resetGift);
    winOverlay.classList.remove("visible");
    update();
  };

  window.addEventListener("resize",resize);

  window.onload=()=>{
    resize();
    spawnGifts();
    update();
  };
</script>
</body>
</html>
